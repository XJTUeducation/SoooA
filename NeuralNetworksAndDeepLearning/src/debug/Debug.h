/*
 * Debug.h
 *
 *  Created on: 2016. 8. 17.
 *      Author: jhkim
 */

#ifndef DEBUG_H_
#define DEBUG_H_

#include <cstdint>
#include <iostream>

#include "../activation/Activation.h"
#include "../dataset/DataSet.h"
#include "../dataset/ImagePackDataSet.h"
#include "../layer/ConvLayer.h"
#include "../layer/DepthConcatLayer.h"
#include "../layer/FullyConnectedLayer.h"
#include "../layer/InputLayer.h"
#include "../layer/LayerConfig.h"
#include "../layer/LRNLayer.h"
#include "../layer/PoolingLayer.h"
#include "../layer/SoftmaxLayer.h"
#include "../network/NetworkConfig.h"
#include "../pooling/Pooling.h"

template <typename Dtype> class DataSet;
template <typename Dtype> class LayersConfig;




template <typename Dtype>
DataSet<Dtype>* createMnistDataSet() {
	DataSet<Dtype>* dataSet = new ImagePackDataSet<Dtype>(
			"/home/jhkim/data/learning/mnist/train_data",
			"/home/jhkim/data/learning/mnist/train_label",
			1,
			"/home/jhkim/data/learning/mnist/test_data",
			"/home/jhkim/data/learning/mnist/test_label",
			1);
	dataSet->setMean({0.13066047740});
	return dataSet;

}

template <typename Dtype>
DataSet<Dtype>* createImageNet10CatDataSet() {
	DataSet<Dtype>* dataSet = new ImagePackDataSet<Dtype>(
			"/home/jhkim/image/ILSVRC2012/save/10cat_100train_100test_100_100/train_data",
			"/home/jhkim/image/ILSVRC2012/save/10cat_100train_100test_100_100/train_label",
			1,
			"/home/jhkim/image/ILSVRC2012/save/10cat_100train_100test_100_100/train_data",
			"/home/jhkim/image/ILSVRC2012/save/10cat_100train_100test_100_100/train_label",
			//"/home/jhkim/image/ILSVRC2012/save/100cat_10000train_1000test_10000_1000/test_data",
			//"/home/jhkim/image/ILSVRC2012/save/100cat_10000train_1000test_10000_1000/test_label",
			1);
	dataSet->setMean({0.47684615850, 0.45469805598, 0.41394191980});
	return dataSet;
}

template <typename Dtype>
DataSet<Dtype>* createImageNet100CatDataSet() {
	DataSet<Dtype>* dataSet = new ImagePackDataSet<Dtype>(
			"/home/jhkim/image/ILSVRC2012/save/100cat_10000train_1000test_10000_1000/train_data",
			"/home/jhkim/image/ILSVRC2012/save/100cat_10000train_1000test_10000_1000/train_label",
			1,
			//"/home/jhkim/image/ILSVRC2012/save/100cat_10000train_1000test_10000_1000/train_data",
			//"/home/jhkim/image/ILSVRC2012/save/100cat_10000train_1000test_10000_1000/train_label",
			"/home/jhkim/image/ILSVRC2012/save/100cat_10000train_1000test_10000_1000/test_data",
			"/home/jhkim/image/ILSVRC2012/save/100cat_10000train_1000test_10000_1000/test_label",
			1);
	dataSet->setMean({0.47684615850, 0.45469805598, 0.41394191980});
	return dataSet;
}

template <typename Dtype>
DataSet<Dtype>* createImageNet1000CatDataSet() {
	DataSet<Dtype>* dataSet = new ImagePackDataSet<Dtype>(
			"/home/jhkim/image/ILSVRC2012/save/1000cat_1000000train_10000test_50000_10000/train_data",
			"/home/jhkim/image/ILSVRC2012/save/1000cat_1000000train_10000test_50000_10000/train_label",
			1,
			"/home/jhkim/image/ILSVRC2012/save/1000cat_1000000train_10000test_50000_10000/test_data",
			"/home/jhkim/image/ILSVRC2012/save/1000cat_1000000train_10000test_50000_10000/test_label",
			1);
	dataSet->setMean({0.47684615850, 0.45469805598, 0.41394191980});
	return dataSet;
}

template <typename Dtype>
DataSet<Dtype>* createImageNet1000CatDataSet2() {
	DataSet<Dtype>* dataSet = new ImagePackDataSet<Dtype>(
			//"/home/jhkim/image/ILSVRC2012/save/1000_1000_1000_1_1/train_data",
			//"/home/jhkim/image/ILSVRC2012/save/1000_1000_1000_1_1/train_label",
			//"/home/jhkim/image/ILSVRC2012/save/1000_10000_1000_1_1/train_data",
			//"/home/jhkim/image/ILSVRC2012/save/1000_10000_1000_1_1/train_label",
			"/home/jhkim/image/ILSVRC2012/save/1000_50000_1000_1_1/train_data",
			"/home/jhkim/image/ILSVRC2012/save/1000_50000_1000_1_1/train_label",
			1,
			"/home/jhkim/image/ILSVRC2012/save/1000_1000_1000_1_1/test_data",
			"/home/jhkim/image/ILSVRC2012/save/1000_1000_1000_1_1/test_label",
			//"/home/jhkim/image/ILSVRC2012/save/1000_10000_1000_1_1/test_data",
			//"/home/jhkim/image/ILSVRC2012/save/1000_10000_1000_1_1/test_label",
			//"/home/jhkim/image/ILSVRC2012/save/1000_50000_1000_1_1/test_data",
			//"/home/jhkim/image/ILSVRC2012/save/1000_50000_1000_1_1/test_label",
			1);
	dataSet->setMean({0.47684615850, 0.45469805598, 0.41394191980});
	return dataSet;
}







template <typename Dtype>
LayersConfig<Dtype>* createCNNSimpleLayersConfig() {
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("inputLayer")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("convLayer1")
					->filterDim(3, 3, 2, 2, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("poolingLayer1")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(3)
					->name("softmaxLayer")
					->nOut(10)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({2}))
			->build();

	return layersConfig;
}


template <typename Dtype>
LayersConfig<Dtype>* createCNNDoubleLayersConfig() {
	const float bias_const = 0.2;

	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("inputLayer")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("convLayer1")
					->filterDim(5, 5, 1, 20, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("poolingLayer1")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(3)
					->name("convLayer2")
					->filterDim(5, 5, 20, 40, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(4)
					->name("poolingLayer2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename FullyConnectedLayer<Dtype>::Builder())
					->id(5)
					->name("fullyConnectedLayer1")
					->nOut(5000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::Type::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(6)
					->name("softmaxLayer")
					->nOut(10)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({5}))
			->build();

	return layersConfig;
}


template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception3ASimpleLayersConfig() {
	const float bias_const = 0.05;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 1, 5, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 5, 10, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 10, 5, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					//->nextLayerIndices({8, 9, 11, 13}))
					->nextLayerIndices({15}))


					/*
			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 5, 5, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					//->nextLayerIndices({15}))
					->nextLayerIndices({15}))
					*/

					/*
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 5, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 3, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 5, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 2, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 5, 3, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
					*/




			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					//->prevLayerIndices({8, 10, 12, 14})
					->prevLayerIndices({7})
					->nextLayerIndices({17}))


					/*

			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(16)
					->name("pool5_7x7_s1")
					->poolDim(2, 2, 1)
					->poolingType(Pooling<Dtype>::Avg)
					//->prevLayerIndices({15})
					->prevLayerIndices({15})
					->nextLayerIndices({17}))
					*/

			->layer((new typename SoftmaxLayer<Dtype>::Builder())
								->id(17)
								->name("softmaxLayer")
								->nOut(10)
								->pDropout(0.4)
								->weightUpdateParam(1, 1)
								->biasUpdateParam(2, 0)
								->weightFiller(ParamFillerType::Xavier, 0.1)
								->biasFiller(ParamFillerType::Constant, 0.0)
								->prevLayerIndices({15}))

						->build();

	return layersConfig;
}

template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception3ALayersConfig() {
	const float xavier_const = 1.0;
	const float bias_const = 0.1;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)	// 0.03
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)	// 0.09
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)	// 0.03
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16}))

			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(16)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({15})
					->nextLayerIndices({17}))

			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(17)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({16}))
			->build();

	return layersConfig;
}


template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception3ALayersConfigTest() {
	const float xavier_const = 1.0;
	const float bias_const = 0.1;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({4}))
					/*
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
					*/
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({2})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({7}))
					/*
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
					*/
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({5})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)	// 0.03
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)	// 0.09
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)	// 0.03
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16}))

			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(16)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({15})
					->nextLayerIndices({17}))

			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(17)
					->name("softmaxLayer")
					->nOut(100)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, xavier_const)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({16}))
			->build();

	return layersConfig;
}


template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception3BLayersConfig() {
	const float bias_const = 0.2;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))


			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25}))



			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(25)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({24})
					->nextLayerIndices({26}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(26)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({25}))
			->build();

	return layersConfig;
}


template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception4ALayersConfig() {
	const float bias_const = 0.2;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))


			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("pool3_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25, 26, 28, 30}))

			//INCEPTION 4A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(25)
					->name("inception_4a/conv1x1")
					->filterDim(1, 1, 480, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(26)
					->name("inception_4a/conv3x3reduce")
					->filterDim(1, 1, 480, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({27}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(27)
					->name("inception_4a/conv3x3")
					->filterDim(3, 3, 96, 208, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({26})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(28)
					->name("inception_4a/conv5x5reduce")
					->filterDim(3, 3, 480, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({29}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(29)
					->name("inception_4a/conv5x5")
					->filterDim(3, 3, 16, 48, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({28})
					->nextLayerIndices({32}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(30)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({24})
					->nextLayerIndices({31}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(31)
					->name("inception_4a/convProjection")
					->filterDim(1, 1, 480, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({30})
					->nextLayerIndices({32}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(32)
					->name("inception_4a/depthConcat")
					->prevLayerIndices({25, 27, 29, 31})
					->nextLayerIndices({33}))



			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(33)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({32})
					->nextLayerIndices({34}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(34)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({33}))
			->build();

	return layersConfig;
}


template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception4BLayersConfig() {
	const float bias_const = 0.2;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))


			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("pool3_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25, 26, 28, 30}))

			//INCEPTION 4A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(25)
					->name("inception_4a/conv1x1")
					->filterDim(1, 1, 480, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(26)
					->name("inception_4a/conv3x3reduce")
					->filterDim(1, 1, 480, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({27}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(27)
					->name("inception_4a/conv3x3")
					->filterDim(3, 3, 96, 208, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({26})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(28)
					->name("inception_4a/conv5x5reduce")
					->filterDim(3, 3, 480, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({29}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(29)
					->name("inception_4a/conv5x5")
					->filterDim(3, 3, 16, 48, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({28})
					->nextLayerIndices({32}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(30)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({24})
					->nextLayerIndices({31}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(31)
					->name("inception_4a/convProjection")
					->filterDim(1, 1, 480, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({30})
					->nextLayerIndices({32}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(32)
					->name("inception_4a/depthConcat")
					->prevLayerIndices({25, 27, 29, 31})
					->nextLayerIndices({33, 34, 36, 38}))



			//INCEPTION 4B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(33)
					->name("inception_4b/conv1x1")
					->filterDim(1, 1, 512, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(34)
					->name("inception_4b/conv3x3reduce")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({35}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(35)
					->name("inception_4b/conv3x3")
					->filterDim(3, 3, 112, 224, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({34})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(36)
					->name("inception_4b/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({37}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(37)
					->name("inception_4b/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({36})
					->nextLayerIndices({40}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(38)
					->name("inception_4b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({32})
					->nextLayerIndices({39}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(39)
					->name("inception_4b/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({38})
					->nextLayerIndices({40}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(40)
					->name("inception_4b/depthConcat")
					->prevLayerIndices({33, 35, 37, 39})
					->nextLayerIndices({41}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(41)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({40})
					->nextLayerIndices({42}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(42)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({41}))
			->build();

	return layersConfig;
}


template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception4CLayersConfig() {
	const float bias_const = 0.2;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))


			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("pool3_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25, 26, 28, 30}))

			//INCEPTION 4A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(25)
					->name("inception_4a/conv1x1")
					->filterDim(1, 1, 480, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(26)
					->name("inception_4a/conv3x3reduce")
					->filterDim(1, 1, 480, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({27}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(27)
					->name("inception_4a/conv3x3")
					->filterDim(3, 3, 96, 208, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({26})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(28)
					->name("inception_4a/conv5x5reduce")
					->filterDim(3, 3, 480, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({29}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(29)
					->name("inception_4a/conv5x5")
					->filterDim(3, 3, 16, 48, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({28})
					->nextLayerIndices({32}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(30)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({24})
					->nextLayerIndices({31}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(31)
					->name("inception_4a/convProjection")
					->filterDim(1, 1, 480, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({30})
					->nextLayerIndices({32}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(32)
					->name("inception_4a/depthConcat")
					->prevLayerIndices({25, 27, 29, 31})
					->nextLayerIndices({33, 34, 36, 38}))



			//INCEPTION 4B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(33)
					->name("inception_4b/conv1x1")
					->filterDim(1, 1, 512, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(34)
					->name("inception_4b/conv3x3reduce")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({35}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(35)
					->name("inception_4b/conv3x3")
					->filterDim(3, 3, 112, 224, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({34})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(36)
					->name("inception_4b/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({37}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(37)
					->name("inception_4b/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({36})
					->nextLayerIndices({40}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(38)
					->name("inception_4b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({32})
					->nextLayerIndices({39}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(39)
					->name("inception_4b/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({38})
					->nextLayerIndices({40}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(40)
					->name("inception_4b/depthConcat")
					->prevLayerIndices({33, 35, 37, 39})
					->nextLayerIndices({41, 42, 44, 46}))



			//INCEPTION 4C
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(41)
					->name("inception_4c/conv1x1")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(42)
					->name("inception_4c/conv3x3reduce")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({43}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(43)
					->name("inception_4c/conv3x3")
					->filterDim(3, 3, 128, 256, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({42})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(44)
					->name("inception_4c/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({45}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(45)
					->name("inception_4c/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({44})
					->nextLayerIndices({48}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(46)
					->name("inception_4c/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({40})
					->nextLayerIndices({47}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(47)
					->name("inception_4c/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({46})
					->nextLayerIndices({48}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(48)
					->name("inception_4c/depthConcat")
					->prevLayerIndices({41, 43, 45, 47})
					->nextLayerIndices({49}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(49)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({48})
					->nextLayerIndices({50}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(50)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({49}))
			->build();

	return layersConfig;
}






template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception4DLayersConfig() {
	const float bias_const = 0.2;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))


			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("pool3_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25, 26, 28, 30}))

			//INCEPTION 4A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(25)
					->name("inception_4a/conv1x1")
					->filterDim(1, 1, 480, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(26)
					->name("inception_4a/conv3x3reduce")
					->filterDim(1, 1, 480, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({27}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(27)
					->name("inception_4a/conv3x3")
					->filterDim(3, 3, 96, 208, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({26})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(28)
					->name("inception_4a/conv5x5reduce")
					->filterDim(3, 3, 480, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({29}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(29)
					->name("inception_4a/conv5x5")
					->filterDim(3, 3, 16, 48, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({28})
					->nextLayerIndices({32}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(30)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({24})
					->nextLayerIndices({31}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(31)
					->name("inception_4a/convProjection")
					->filterDim(1, 1, 480, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({30})
					->nextLayerIndices({32}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(32)
					->name("inception_4a/depthConcat")
					->prevLayerIndices({25, 27, 29, 31})
					->nextLayerIndices({33, 34, 36, 38}))



			//INCEPTION 4B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(33)
					->name("inception_4b/conv1x1")
					->filterDim(1, 1, 512, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(34)
					->name("inception_4b/conv3x3reduce")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({35}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(35)
					->name("inception_4b/conv3x3")
					->filterDim(3, 3, 112, 224, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({34})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(36)
					->name("inception_4b/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({37}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(37)
					->name("inception_4b/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({36})
					->nextLayerIndices({40}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(38)
					->name("inception_4b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({32})
					->nextLayerIndices({39}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(39)
					->name("inception_4b/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({38})
					->nextLayerIndices({40}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(40)
					->name("inception_4b/depthConcat")
					->prevLayerIndices({33, 35, 37, 39})
					->nextLayerIndices({41, 42, 44, 46}))



			//INCEPTION 4C
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(41)
					->name("inception_4c/conv1x1")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(42)
					->name("inception_4c/conv3x3reduce")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({43}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(43)
					->name("inception_4c/conv3x3")
					->filterDim(3, 3, 128, 256, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({42})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(44)
					->name("inception_4c/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({45}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(45)
					->name("inception_4c/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({44})
					->nextLayerIndices({48}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(46)
					->name("inception_4c/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({40})
					->nextLayerIndices({47}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(47)
					->name("inception_4c/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({46})
					->nextLayerIndices({48}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(48)
					->name("inception_4c/depthConcat")
					->prevLayerIndices({41, 43, 45, 47})
					->nextLayerIndices({49, 50, 52, 54}))




			//INCEPTION 4D
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(49)
					->name("inception_4d/conv1x1")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(50)
					->name("inception_4d/conv3x3reduce")
					->filterDim(1, 1, 512, 144, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({51}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(51)
					->name("inception_4d/conv3x3")
					->filterDim(3, 3, 144, 288, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({50})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(52)
					->name("inception_4d/conv5x5reduce")
					->filterDim(3, 3, 512, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({53}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(53)
					->name("inception_4d/conv5x5")
					->filterDim(3, 3, 32, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({52})
					->nextLayerIndices({56}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(54)
					->name("inception_4d/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({48})
					->nextLayerIndices({55}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(55)
					->name("inception_4d/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({54})
					->nextLayerIndices({56}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(56)
					->name("inception_4d/depthConcat")
					->prevLayerIndices({49, 51, 53, 55})
					->nextLayerIndices({57}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(57)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({56})
					->nextLayerIndices({58}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(58)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({57}))
			->build();

	return layersConfig;
}











template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception4ELayersConfig() {
	const float bias_const = 0.2;

	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))


			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("pool3_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25, 26, 28, 30}))

			//INCEPTION 4A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(25)
					->name("inception_4a/conv1x1")
					->filterDim(1, 1, 480, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(26)
					->name("inception_4a/conv3x3reduce")
					->filterDim(1, 1, 480, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({27}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(27)
					->name("inception_4a/conv3x3")
					->filterDim(3, 3, 96, 208, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({26})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(28)
					->name("inception_4a/conv5x5reduce")
					->filterDim(3, 3, 480, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({29}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(29)
					->name("inception_4a/conv5x5")
					->filterDim(3, 3, 16, 48, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({28})
					->nextLayerIndices({32}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(30)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({24})
					->nextLayerIndices({31}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(31)
					->name("inception_4a/convProjection")
					->filterDim(1, 1, 480, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({30})
					->nextLayerIndices({32}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(32)
					->name("inception_4a/depthConcat")
					->prevLayerIndices({25, 27, 29, 31})
					->nextLayerIndices({33, 34, 36, 38}))



			//INCEPTION 4B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(33)
					->name("inception_4b/conv1x1")
					->filterDim(1, 1, 512, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(34)
					->name("inception_4b/conv3x3reduce")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({35}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(35)
					->name("inception_4b/conv3x3")
					->filterDim(3, 3, 112, 224, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({34})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(36)
					->name("inception_4b/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({37}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(37)
					->name("inception_4b/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({36})
					->nextLayerIndices({40}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(38)
					->name("inception_4b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({32})
					->nextLayerIndices({39}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(39)
					->name("inception_4b/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({38})
					->nextLayerIndices({40}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(40)
					->name("inception_4b/depthConcat")
					->prevLayerIndices({33, 35, 37, 39})
					->nextLayerIndices({41, 42, 44, 46}))



			//INCEPTION 4C
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(41)
					->name("inception_4c/conv1x1")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(42)
					->name("inception_4c/conv3x3reduce")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({43}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(43)
					->name("inception_4c/conv3x3")
					->filterDim(3, 3, 128, 256, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({42})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(44)
					->name("inception_4c/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({45}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(45)
					->name("inception_4c/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({44})
					->nextLayerIndices({48}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(46)
					->name("inception_4c/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({40})
					->nextLayerIndices({47}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(47)
					->name("inception_4c/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({46})
					->nextLayerIndices({48}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(48)
					->name("inception_4c/depthConcat")
					->prevLayerIndices({41, 43, 45, 47})
					->nextLayerIndices({49, 50, 52, 54}))




			//INCEPTION 4D
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(49)
					->name("inception_4d/conv1x1")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(50)
					->name("inception_4d/conv3x3reduce")
					->filterDim(1, 1, 512, 144, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({51}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(51)
					->name("inception_4d/conv3x3")
					->filterDim(3, 3, 144, 288, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({50})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(52)
					->name("inception_4d/conv5x5reduce")
					->filterDim(3, 3, 512, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({53}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(53)
					->name("inception_4d/conv5x5")
					->filterDim(3, 3, 32, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({52})
					->nextLayerIndices({56}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(54)
					->name("inception_4d/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({48})
					->nextLayerIndices({55}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(55)
					->name("inception_4d/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({54})
					->nextLayerIndices({56}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(56)
					->name("inception_4d/depthConcat")
					->prevLayerIndices({49, 51, 53, 55})
					->nextLayerIndices({57, 58, 60, 62}))

			//INCEPTION 4E
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(57)
					->name("inception_4e/conv1x1")
					->filterDim(1, 1, 528, 256, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({64}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(58)
					->name("inception_4e/conv3x3reduce")
					->filterDim(1, 1, 528, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({59}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(59)
					->name("inception_4e/conv3x3")
					->filterDim(3, 3, 160, 320, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({58})
					->nextLayerIndices({64}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(60)
					->name("inception_4e/conv5x5reduce")
					->filterDim(3, 3, 528, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({61}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(61)
					->name("inception_4e/conv5x5")
					->filterDim(3, 3, 32, 128, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({60})
					->nextLayerIndices({64}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(62)
					->name("inception_4e/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({56})
					->nextLayerIndices({63}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(63)
					->name("inception_4e/convProjection")
					->filterDim(1, 1, 528, 128, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({62})
					->nextLayerIndices({64}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(64)
					->name("inception_4e/depthConcat")
					->prevLayerIndices({57, 59, 61, 63})
					->nextLayerIndices({65}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(65)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({64})
					->nextLayerIndices({66}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(66)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({65}))
			->build();

	return layersConfig;
}










template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception5ALayersConfig() {
	const float bias_const = 0.2;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))


			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("pool3_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25, 26, 28, 30}))

			//INCEPTION 4A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(25)
					->name("inception_4a/conv1x1")
					->filterDim(1, 1, 480, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(26)
					->name("inception_4a/conv3x3reduce")
					->filterDim(1, 1, 480, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({27}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(27)
					->name("inception_4a/conv3x3")
					->filterDim(3, 3, 96, 208, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({26})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(28)
					->name("inception_4a/conv5x5reduce")
					->filterDim(3, 3, 480, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({29}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(29)
					->name("inception_4a/conv5x5")
					->filterDim(3, 3, 16, 48, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({28})
					->nextLayerIndices({32}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(30)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({24})
					->nextLayerIndices({31}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(31)
					->name("inception_4a/convProjection")
					->filterDim(1, 1, 480, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({30})
					->nextLayerIndices({32}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(32)
					->name("inception_4a/depthConcat")
					->prevLayerIndices({25, 27, 29, 31})
					->nextLayerIndices({33, 34, 36, 38}))



			//INCEPTION 4B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(33)
					->name("inception_4b/conv1x1")
					->filterDim(1, 1, 512, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(34)
					->name("inception_4b/conv3x3reduce")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({35}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(35)
					->name("inception_4b/conv3x3")
					->filterDim(3, 3, 112, 224, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({34})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(36)
					->name("inception_4b/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({37}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(37)
					->name("inception_4b/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({36})
					->nextLayerIndices({40}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(38)
					->name("inception_4b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({32})
					->nextLayerIndices({39}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(39)
					->name("inception_4b/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({38})
					->nextLayerIndices({40}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(40)
					->name("inception_4b/depthConcat")
					->prevLayerIndices({33, 35, 37, 39})
					->nextLayerIndices({41, 42, 44, 46}))



			//INCEPTION 4C
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(41)
					->name("inception_4c/conv1x1")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(42)
					->name("inception_4c/conv3x3reduce")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({43}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(43)
					->name("inception_4c/conv3x3")
					->filterDim(3, 3, 128, 256, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({42})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(44)
					->name("inception_4c/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({45}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(45)
					->name("inception_4c/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({44})
					->nextLayerIndices({48}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(46)
					->name("inception_4c/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({40})
					->nextLayerIndices({47}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(47)
					->name("inception_4c/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({46})
					->nextLayerIndices({48}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(48)
					->name("inception_4c/depthConcat")
					->prevLayerIndices({41, 43, 45, 47})
					->nextLayerIndices({49, 50, 52, 54}))




			//INCEPTION 4D
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(49)
					->name("inception_4d/conv1x1")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(50)
					->name("inception_4d/conv3x3reduce")
					->filterDim(1, 1, 512, 144, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({51}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(51)
					->name("inception_4d/conv3x3")
					->filterDim(3, 3, 144, 288, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({50})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(52)
					->name("inception_4d/conv5x5reduce")
					->filterDim(3, 3, 512, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({53}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(53)
					->name("inception_4d/conv5x5")
					->filterDim(3, 3, 32, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({52})
					->nextLayerIndices({56}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(54)
					->name("inception_4d/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({48})
					->nextLayerIndices({55}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(55)
					->name("inception_4d/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({54})
					->nextLayerIndices({56}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(56)
					->name("inception_4d/depthConcat")
					->prevLayerIndices({49, 51, 53, 55})
					->nextLayerIndices({57, 58, 60, 62}))

			//INCEPTION 4E
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(57)
					->name("inception_4e/conv1x1")
					->filterDim(1, 1, 528, 256, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({64}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(58)
					->name("inception_4e/conv3x3reduce")
					->filterDim(1, 1, 528, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({59}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(59)
					->name("inception_4e/conv3x3")
					->filterDim(3, 3, 160, 320, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({58})
					->nextLayerIndices({64}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(60)
					->name("inception_4e/conv5x5reduce")
					->filterDim(3, 3, 528, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({61}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(61)
					->name("inception_4e/conv5x5")
					->filterDim(3, 3, 32, 128, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({60})
					->nextLayerIndices({64}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(62)
					->name("inception_4e/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({56})
					->nextLayerIndices({63}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(63)
					->name("inception_4e/convProjection")
					->filterDim(1, 1, 528, 128, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({62})
					->nextLayerIndices({64}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(64)
					->name("inception_4e/depthConcat")
					->prevLayerIndices({57, 59, 61, 63})
					->nextLayerIndices({65}))







			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(65)
					->name("pool4_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({64})
					->nextLayerIndices({66, 67, 69, 71}))

			//INCEPTION 5A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(66)
					->name("inception_5a/conv1x1")
					->filterDim(1, 1, 832, 256, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({65})
					->nextLayerIndices({73}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(67)
					->name("inception_5a/conv3x3reduce")
					->filterDim(1, 1, 832, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({65})
					->nextLayerIndices({68}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(68)
					->name("inception_5a/conv3x3")
					->filterDim(3, 3, 160, 320, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({67})
					->nextLayerIndices({73}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(69)
					->name("inception_5a/conv5x5reduce")
					->filterDim(3, 3, 832, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({65})
					->nextLayerIndices({70}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(70)
					->name("inception_5a/conv5x5")
					->filterDim(3, 3, 32, 128, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({69})
					->nextLayerIndices({73}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(71)
					->name("inception_5a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({65})
					->nextLayerIndices({72}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(72)
					->name("inception_5a/convProjection")
					->filterDim(1, 1, 832, 128, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({71})
					->nextLayerIndices({73}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(73)
					->name("inception_5a/depthConcat")
					->prevLayerIndices({66, 68, 70, 72})
					->nextLayerIndices({74}))














			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(74)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({73})
					->nextLayerIndices({75}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(75)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({74}))
			->build();

	return layersConfig;
}






template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInception5BLayersConfig() {
	const float bias_const = 0.2;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))


			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("pool3_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25, 26, 28, 30}))

			//INCEPTION 4A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(25)
					->name("inception_4a/conv1x1")
					->filterDim(1, 1, 480, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(26)
					->name("inception_4a/conv3x3reduce")
					->filterDim(1, 1, 480, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({27}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(27)
					->name("inception_4a/conv3x3")
					->filterDim(3, 3, 96, 208, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({26})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(28)
					->name("inception_4a/conv5x5reduce")
					->filterDim(3, 3, 480, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({29}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(29)
					->name("inception_4a/conv5x5")
					->filterDim(3, 3, 16, 48, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({28})
					->nextLayerIndices({32}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(30)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({24})
					->nextLayerIndices({31}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(31)
					->name("inception_4a/convProjection")
					->filterDim(1, 1, 480, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({30})
					->nextLayerIndices({32}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(32)
					->name("inception_4a/depthConcat")
					->prevLayerIndices({25, 27, 29, 31})
					->nextLayerIndices({33, 34, 36, 38}))



			//INCEPTION 4B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(33)
					->name("inception_4b/conv1x1")
					->filterDim(1, 1, 512, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(34)
					->name("inception_4b/conv3x3reduce")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({35}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(35)
					->name("inception_4b/conv3x3")
					->filterDim(3, 3, 112, 224, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({34})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(36)
					->name("inception_4b/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({37}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(37)
					->name("inception_4b/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({36})
					->nextLayerIndices({40}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(38)
					->name("inception_4b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({32})
					->nextLayerIndices({39}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(39)
					->name("inception_4b/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({38})
					->nextLayerIndices({40}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(40)
					->name("inception_4b/depthConcat")
					->prevLayerIndices({33, 35, 37, 39})
					->nextLayerIndices({41, 42, 44, 46}))



			//INCEPTION 4C
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(41)
					->name("inception_4c/conv1x1")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(42)
					->name("inception_4c/conv3x3reduce")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({43}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(43)
					->name("inception_4c/conv3x3")
					->filterDim(3, 3, 128, 256, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({42})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(44)
					->name("inception_4c/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({45}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(45)
					->name("inception_4c/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({44})
					->nextLayerIndices({48}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(46)
					->name("inception_4c/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({40})
					->nextLayerIndices({47}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(47)
					->name("inception_4c/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({46})
					->nextLayerIndices({48}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(48)
					->name("inception_4c/depthConcat")
					->prevLayerIndices({41, 43, 45, 47})
					->nextLayerIndices({49, 50, 52, 54}))




			//INCEPTION 4D
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(49)
					->name("inception_4d/conv1x1")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(50)
					->name("inception_4d/conv3x3reduce")
					->filterDim(1, 1, 512, 144, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({51}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(51)
					->name("inception_4d/conv3x3")
					->filterDim(3, 3, 144, 288, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({50})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(52)
					->name("inception_4d/conv5x5reduce")
					->filterDim(3, 3, 512, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({53}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(53)
					->name("inception_4d/conv5x5")
					->filterDim(3, 3, 32, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({52})
					->nextLayerIndices({56}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(54)
					->name("inception_4d/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({48})
					->nextLayerIndices({55}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(55)
					->name("inception_4d/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({54})
					->nextLayerIndices({56}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(56)
					->name("inception_4d/depthConcat")
					->prevLayerIndices({49, 51, 53, 55})
					->nextLayerIndices({57, 58, 60, 62}))

			//INCEPTION 4E
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(57)
					->name("inception_4e/conv1x1")
					->filterDim(1, 1, 528, 256, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({64}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(58)
					->name("inception_4e/conv3x3reduce")
					->filterDim(1, 1, 528, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({59}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(59)
					->name("inception_4e/conv3x3")
					->filterDim(3, 3, 160, 320, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({58})
					->nextLayerIndices({64}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(60)
					->name("inception_4e/conv5x5reduce")
					->filterDim(3, 3, 528, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({61}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(61)
					->name("inception_4e/conv5x5")
					->filterDim(3, 3, 32, 128, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({60})
					->nextLayerIndices({64}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(62)
					->name("inception_4e/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({56})
					->nextLayerIndices({63}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(63)
					->name("inception_4e/convProjection")
					->filterDim(1, 1, 528, 128, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({62})
					->nextLayerIndices({64}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(64)
					->name("inception_4e/depthConcat")
					->prevLayerIndices({57, 59, 61, 63})
					->nextLayerIndices({65}))







			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(65)
					->name("pool4_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({64})
					->nextLayerIndices({66, 67, 69, 71}))

			//INCEPTION 5A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(66)
					->name("inception_5a/conv1x1")
					->filterDim(1, 1, 832, 256, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({65})
					->nextLayerIndices({73}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(67)
					->name("inception_5a/conv3x3reduce")
					->filterDim(1, 1, 832, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({65})
					->nextLayerIndices({68}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(68)
					->name("inception_5a/conv3x3")
					->filterDim(3, 3, 160, 320, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({67})
					->nextLayerIndices({73}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(69)
					->name("inception_5a/conv5x5reduce")
					->filterDim(3, 3, 832, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({65})
					->nextLayerIndices({70}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(70)
					->name("inception_5a/conv5x5")
					->filterDim(3, 3, 32, 128, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({69})
					->nextLayerIndices({73}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(71)
					->name("inception_5a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({65})
					->nextLayerIndices({72}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(72)
					->name("inception_5a/convProjection")
					->filterDim(1, 1, 832, 128, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({71})
					->nextLayerIndices({73}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(73)
					->name("inception_5a/depthConcat")
					->prevLayerIndices({66, 68, 70, 72})
					->nextLayerIndices({74, 75, 77, 79}))



			//INCEPTION 5B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(74)
					->name("inception_5b/conv1x1")
					->filterDim(1, 1, 832, 384, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({73})
					->nextLayerIndices({81}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(75)
					->name("inception_5b/conv3x3reduce")
					->filterDim(1, 1, 832, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({73})
					->nextLayerIndices({76}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(76)
					->name("inception_5b/conv3x3")
					->filterDim(3, 3, 192, 384, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({75})
					->nextLayerIndices({81}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(77)
					->name("inception_5b/conv5x5reduce")
					->filterDim(3, 3, 832, 48, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({73})
					->nextLayerIndices({78}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(78)
					->name("inception_5b/conv5x5")
					->filterDim(3, 3, 48, 128, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({77})
					->nextLayerIndices({81}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(79)
					->name("inception_5b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({73})
					->nextLayerIndices({80}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(80)
					->name("inception_5b/convProjection")
					->filterDim(1, 1, 832, 128, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({79})
					->nextLayerIndices({81}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(81)
					->name("inception_5b/depthConcat")
					->prevLayerIndices({74, 76, 78, 80})
					->nextLayerIndices({82}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(82)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({81})
					->nextLayerIndices({83}))

			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(83)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({82}))
			->build();

	return layersConfig;
}



template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetInceptionAuxLayersConfig() {
	const float bias_const = 0.2;

	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))


			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))


			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("pool3_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25, 26, 28, 30}))

			//INCEPTION 4A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(25)
					->name("inception_4a/conv1x1")
					->filterDim(1, 1, 480, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(26)
					->name("inception_4a/conv3x3reduce")
					->filterDim(1, 1, 480, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({27}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(27)
					->name("inception_4a/conv3x3")
					->filterDim(3, 3, 96, 208, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({26})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(28)
					->name("inception_4a/conv5x5reduce")
					->filterDim(3, 3, 480, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({29}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(29)
					->name("inception_4a/conv5x5")
					->filterDim(3, 3, 16, 48, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({28})
					->nextLayerIndices({32}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(30)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({24})
					->nextLayerIndices({31}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(31)
					->name("inception_4a/convProjection")
					->filterDim(1, 1, 480, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({30})
					->nextLayerIndices({32}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(32)
					->name("inception_4a/depthConcat")
					->prevLayerIndices({25, 27, 29, 31})
					->nextLayerIndices({33, 34, 36, 38, 88}))



			//INCEPTION 4B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(33)
					->name("inception_4b/conv1x1")
					->filterDim(1, 1, 512, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(34)
					->name("inception_4b/conv3x3reduce")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({35}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(35)
					->name("inception_4b/conv3x3")
					->filterDim(3, 3, 112, 224, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({34})
					->nextLayerIndices({40}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(36)
					->name("inception_4b/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({32})
					->nextLayerIndices({37}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(37)
					->name("inception_4b/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({36})
					->nextLayerIndices({40}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(38)
					->name("inception_4b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({32})
					->nextLayerIndices({39}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(39)
					->name("inception_4b/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({38})
					->nextLayerIndices({40}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(40)
					->name("inception_4b/depthConcat")
					->prevLayerIndices({33, 35, 37, 39})
					->nextLayerIndices({41, 42, 44, 46}))



			//INCEPTION 4C
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(41)
					->name("inception_4c/conv1x1")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(42)
					->name("inception_4c/conv3x3reduce")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({43}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(43)
					->name("inception_4c/conv3x3")
					->filterDim(3, 3, 128, 256, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({42})
					->nextLayerIndices({48}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(44)
					->name("inception_4c/conv5x5reduce")
					->filterDim(3, 3, 512, 24, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({40})
					->nextLayerIndices({45}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(45)
					->name("inception_4c/conv5x5")
					->filterDim(3, 3, 24, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({44})
					->nextLayerIndices({48}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(46)
					->name("inception_4c/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({40})
					->nextLayerIndices({47}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(47)
					->name("inception_4c/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({46})
					->nextLayerIndices({48}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(48)
					->name("inception_4c/depthConcat")
					->prevLayerIndices({41, 43, 45, 47})
					->nextLayerIndices({49, 50, 52, 54}))




			//INCEPTION 4D
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(49)
					->name("inception_4d/conv1x1")
					->filterDim(1, 1, 512, 112, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(50)
					->name("inception_4d/conv3x3reduce")
					->filterDim(1, 1, 512, 144, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({51}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(51)
					->name("inception_4d/conv3x3")
					->filterDim(3, 3, 144, 288, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({50})
					->nextLayerIndices({56}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(52)
					->name("inception_4d/conv5x5reduce")
					->filterDim(3, 3, 512, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({48})
					->nextLayerIndices({53}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(53)
					->name("inception_4d/conv5x5")
					->filterDim(3, 3, 32, 64, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({52})
					->nextLayerIndices({56}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(54)
					->name("inception_4d/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({48})
					->nextLayerIndices({55}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(55)
					->name("inception_4d/convProjection")
					->filterDim(1, 1, 512, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({54})
					->nextLayerIndices({56}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(56)
					->name("inception_4d/depthConcat")
					->prevLayerIndices({49, 51, 53, 55})
					->nextLayerIndices({57, 58, 60, 62, 84}))

			//INCEPTION 4E
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(57)
					->name("inception_4e/conv1x1")
					->filterDim(1, 1, 528, 256, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({64}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(58)
					->name("inception_4e/conv3x3reduce")
					->filterDim(1, 1, 528, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({59}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(59)
					->name("inception_4e/conv3x3")
					->filterDim(3, 3, 160, 320, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({58})
					->nextLayerIndices({64}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(60)
					->name("inception_4e/conv5x5reduce")
					->filterDim(3, 3, 528, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({56})
					->nextLayerIndices({61}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(61)
					->name("inception_4e/conv5x5")
					->filterDim(3, 3, 32, 128, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({60})
					->nextLayerIndices({64}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(62)
					->name("inception_4e/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({56})
					->nextLayerIndices({63}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(63)
					->name("inception_4e/convProjection")
					->filterDim(1, 1, 528, 128, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({62})
					->nextLayerIndices({64}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(64)
					->name("inception_4e/depthConcat")
					->prevLayerIndices({57, 59, 61, 63})
					->nextLayerIndices({65}))







			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(65)
					->name("pool4_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({64})
					->nextLayerIndices({66, 67, 69, 71}))

			//INCEPTION 5A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(66)
					->name("inception_5a/conv1x1")
					->filterDim(1, 1, 832, 256, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({65})
					->nextLayerIndices({73}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(67)
					->name("inception_5a/conv3x3reduce")
					->filterDim(1, 1, 832, 160, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({65})
					->nextLayerIndices({68}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(68)
					->name("inception_5a/conv3x3")
					->filterDim(3, 3, 160, 320, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({67})
					->nextLayerIndices({73}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(69)
					->name("inception_5a/conv5x5reduce")
					->filterDim(3, 3, 832, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({65})
					->nextLayerIndices({70}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(70)
					->name("inception_5a/conv5x5")
					->filterDim(3, 3, 32, 128, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({69})
					->nextLayerIndices({73}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(71)
					->name("inception_5a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({65})
					->nextLayerIndices({72}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(72)
					->name("inception_5a/convProjection")
					->filterDim(1, 1, 832, 128, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({71})
					->nextLayerIndices({73}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(73)
					->name("inception_5a/depthConcat")
					->prevLayerIndices({66, 68, 70, 72})
					->nextLayerIndices({74, 75, 77, 79}))



			//INCEPTION 5B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(74)
					->name("inception_5b/conv1x1")
					->filterDim(1, 1, 832, 384, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({73})
					->nextLayerIndices({81}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(75)
					->name("inception_5b/conv3x3reduce")
					->filterDim(1, 1, 832, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({73})
					->nextLayerIndices({76}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(76)
					->name("inception_5b/conv3x3")
					->filterDim(3, 3, 192, 384, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({75})
					->nextLayerIndices({81}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(77)
					->name("inception_5b/conv5x5reduce")
					->filterDim(3, 3, 832, 48, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({73})
					->nextLayerIndices({78}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(78)
					->name("inception_5b/conv5x5")
					->filterDim(3, 3, 48, 128, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({77})
					->nextLayerIndices({81}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(79)
					->name("inception_5b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({73})
					->nextLayerIndices({80}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(80)
					->name("inception_5b/convProjection")
					->filterDim(1, 1, 832, 128, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({79})
					->nextLayerIndices({81}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(81)
					->name("inception_5b/depthConcat")
					->prevLayerIndices({74, 76, 78, 80})
					->nextLayerIndices({82}))







			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(82)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({81})
					->nextLayerIndices({83}))

			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(83)
					->name("softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({82}))











			// AUX 1
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(88)
					->name("loss1/ave_pool")
					->poolDim(5, 5, 3)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({32})
					->nextLayerIndices({89}))

			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(89)
					->name("loss1/conv")
					->filterDim(1, 1, 512, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({88})
					->nextLayerIndices({90}))

			->layer((new typename FullyConnectedLayer<Dtype>::Builder())
					->id(90)
					->name("loss1/fc")
					->nOut(1024)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::Type::ReLU)
					->prevLayerIndices({89})
					->nextLayerIndices({91}))

			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(91)
					->name("loss1/softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({90}))



			// AUX 2
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(84)
					->name("loss2/ave_pool")
					->poolDim(5, 5, 3)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({56})
					->nextLayerIndices({85}))

			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(85)
					->name("loss2/conv")
					->filterDim(1, 1, 528, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({84})
					->nextLayerIndices({86}))

			->layer((new typename FullyConnectedLayer<Dtype>::Builder())
					->id(86)
					->name("loss2/fc")
					->nOut(1024)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::Type::ReLU)
					->prevLayerIndices({85})
					->nextLayerIndices({87}))

			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(87)
					->name("loss2/softmaxLayer")
					->nOut(1000)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({86}))
































			->build();

	return layersConfig;
}







































template <typename Dtype>
LayersConfig<Dtype>* createGoogLeNetLayersConfig() {
	const float bias_const = 0.05;


	cout << endl;
	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("conv1_7x7_s2")
					->filterDim(7, 7, 3, 64, 2)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({2}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(2)
					->name("pool1_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({1})
					->nextLayerIndices({3}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(3)
					->name("lrn1")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({2})
					->nextLayerIndices({4}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("conv2_3x3_reduce")
					->filterDim(1, 1, 64, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({3})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("conv2_3x3")
					->filterDim(3, 3, 64, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({6}))
			->layer((new typename LRNLayer<Dtype>::Builder())
					->id(6)
					->name("lrn2")
					->lrnDim(5, 0.0001, 0.75, 2.0)
					->prevLayerIndices({5})
					->nextLayerIndices({7}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(7)
					->name("pool2_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({6})
					->nextLayerIndices({8, 9, 11, 13}))

			//INCEPTION 3A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(9)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({10}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(10)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({9})
					->nextLayerIndices({15}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(11)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({7})
					->nextLayerIndices({12}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(12)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({11})
					->nextLayerIndices({15}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(13)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({7})
					->nextLayerIndices({14}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(14)
					->name("inception_3a/convProjection")
					->filterDim(1, 1, 192, 32, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({13})
					->nextLayerIndices({15}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(15)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({16, 17, 19, 21}))

			//INCEPTION 3B
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(16)
					->name("inception_3b/conv1x1")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(17)
					->name("inception_3b/conv3x3reduce")
					->filterDim(1, 1, 256, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({18}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(18)
					->name("inception_3b/conv3x3")
					->filterDim(3, 3, 128, 192, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({17})
					->nextLayerIndices({23}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(19)
					->name("inception_3b/conv5x5reduce")
					->filterDim(3, 3, 256, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({15})
					->nextLayerIndices({20}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(20)
					->name("inception_3b/conv5x5")
					->filterDim(3, 3, 32, 96, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({19})
					->nextLayerIndices({23}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(21)
					->name("inception_3b/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({15})
					->nextLayerIndices({22}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(22)
					->name("inception_3b/convProjection")
					->filterDim(1, 1, 256, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({21})
					->nextLayerIndices({23}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(23)
					->name("inception_3b/depthConcat")
					->prevLayerIndices({16, 18, 20, 22})
					->nextLayerIndices({24}))

			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(24)
					->name("pool3_3x3_s2")
					->poolDim(3, 3, 2)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({23})
					->nextLayerIndices({25, 26, 28, 30}))

			//INCEPTION 4A
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(25)
					->name("inception_4a/conv1x1")
					->filterDim(1, 1, 480, 192, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(26)
					->name("inception_4a/conv3x3reduce")
					->filterDim(1, 1, 480, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.09)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({27}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(27)
					->name("inception_4a/conv3x3")
					->filterDim(3, 3, 96, 208, 1)
					//->filterDim(3, 3, 96, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.03)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({26})
					->nextLayerIndices({32}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(28)
					->name("inception_4a/conv5x5reduce")
					->filterDim(3, 3, 480, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({24})
					->nextLayerIndices({29}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(29)
					->name("inception_4a/conv5x5")
					->filterDim(3, 3, 16, 48, 1)
					//->filterDim(3, 3, 16, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({28})
					->nextLayerIndices({32}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(30)
					->name("inception_4a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({24})
					->nextLayerIndices({31}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(31)
					->name("inception_4a/convProjection")
					->filterDim(1, 1, 480, 64, 1)
					//->filterDim(3, 3, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, bias_const)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({30})
					->nextLayerIndices({32}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(32)
					->name("inception_4a/depthConcat")
					->prevLayerIndices({25, 27, 29, 31})
					->nextLayerIndices({33}))

			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(33)
					->name("pool5_7x7_s1")
					->poolDim(7, 7, 4)
					->poolingType(Pooling<Dtype>::Avg)
					->prevLayerIndices({32})
					//->prevLayerIndices({8, 10, 12, 14})
					->nextLayerIndices({34}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(34)
					->name("softmaxLayer")
					->nOut(100)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({33}))
			->build();

	return layersConfig;



}



template <typename Dtype>
LayersConfig<Dtype>* createInceptionLayersConfig() {
	uint32_t layerId = 0;
	const uint32_t ic = 1;
	const uint32_t oc_cv1x1 = 1;
	const uint32_t oc_cv3x3reduce = 1;
	const uint32_t oc_cv3x3 = 2;
	const uint32_t oc_cv5x5reduce = 1;
	const uint32_t oc_cv5x5 = 3;
	const uint32_t oc_cp = 2;


	LayersConfig<Dtype>* layersConfig =
			(new typename LayersConfig<Dtype>::Builder())
			->layer((new typename InputLayer<Dtype>::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1, 2, 4, 6}))

			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(1)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, ic, oc_cv1x1, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({8}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(2)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, ic, oc_cv3x3reduce, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({3}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(3)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, oc_cv3x3reduce, oc_cv3x3, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({2})
					->nextLayerIndices({8}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(4)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, ic, oc_cv5x5reduce, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({5}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(5)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, oc_cv5x5reduce, oc_cv5x5, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({8}))
			->layer((new typename PoolingLayer<Dtype>::Builder())
					->id(6)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling<Dtype>::Max)
					->prevLayerIndices({0})
					->nextLayerIndices({7}))
			->layer((new typename ConvLayer<Dtype>::Builder())
					->id(7)
					->name("inception_3a/convProjection")
					->filterDim(3, 3, ic, oc_cp, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation<Dtype>::ReLU)
					->prevLayerIndices({6})
					->nextLayerIndices({8}))
			->layer((new typename DepthConcatLayer<Dtype>::Builder())
					->id(8)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({1, 3, 5, 7})
					->nextLayerIndices({9}))
			->layer((new typename SoftmaxLayer<Dtype>::Builder())
					->id(9)
					->name("softmaxLayer")
					->nOut(10)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({8}))
			->build();



	/*
	LayersConfig* layersConfig =
			(new LayersConfig::Builder())
			->layer((new InputLayer::Builder())
					->id(0)
					->name("input")
					->nextLayerIndices({1, 2, 4, 6}))

			->layer((new ConvLayer::Builder())
					->id(1)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({8}))

			->layer((new ConvLayer::Builder())
					->id(1)
					->name("inception_3a/conv1x1")
					->filterDim(1, 1, 192, 64, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({8}))
			->layer((new ConvLayer::Builder())
					->id(2)
					->name("inception_3a/conv3x3reduce")
					->filterDim(1, 1, 192, 96, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({3}))
			->layer((new ConvLayer::Builder())
					->id(3)
					->name("inception_3a/conv3x3")
					->filterDim(3, 3, 96, 128, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation::ReLU)
					->prevLayerIndices({2})
					->nextLayerIndices({8}))
			->layer((new ConvLayer::Builder())
					->id(4)
					->name("inception_3a/conv5x5reduce")
					->filterDim(3, 3, 192, 16, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation::ReLU)
					->prevLayerIndices({0})
					->nextLayerIndices({5}))
			->layer((new ConvLayer::Builder())
					->id(5)
					->name("inception_3a/conv5x5")
					->filterDim(3, 3, 16, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation::ReLU)
					->prevLayerIndices({4})
					->nextLayerIndices({8}))
			->layer((new PoolingLayer::Builder())
					->id(6)
					->name("inception_3a/pool3x3")
					->poolDim(3, 3, 1)
					->poolingType(Pooling::Max)
					->prevLayerIndices({0})
					->nextLayerIndices({7}))
			->layer((new ConvLayer::Builder())
					->id(7)
					->name("inception_3a/convProjection")
					->filterDim(3, 3, 96, 32, 1)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.2)
					->activationType(Activation::ReLU)
					->prevLayerIndices({6})
					->nextLayerIndices({8}))
			->layer((new DepthConcatLayer::Builder())
					->id(8)
					->name("inception_3a/depthConcat")
					->prevLayerIndices({1, 3, 5, 7})
					->nextLayerIndices({9}))
			->layer((new SoftmaxLayer::Builder())
					->id(9)
					->name("softmaxLayer")
					->nOut(100)
					->pDropout(0.4)
					->weightUpdateParam(1, 1)
					->biasUpdateParam(2, 0)
					->weightFiller(ParamFillerType::Xavier, 0.1)
					->biasFiller(ParamFillerType::Constant, 0.0)
					->prevLayerIndices({8}))
			->build();
			*/

	return layersConfig;



}









#endif /* DEBUG_H_ */
